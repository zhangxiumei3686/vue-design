<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VueæŠ€æœ¯å†…å¹• | æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶</title>
    <meta name="description" content="é€è¡Œçº§åˆ«çš„ Vue æºç åˆ†æ">
    <script async="" src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <link rel="icon" href="/vue-design/logo.png">
    
    <link rel="preload" href="/vue-design/assets/css/0.styles.513e2ce8.css" as="style"><link rel="preload" href="/vue-design/assets/js/app.bfcf3ece.js" as="script"><link rel="preload" href="/vue-design/assets/js/2.f22f200a.js" as="script"><link rel="prefetch" href="/vue-design/assets/js/16.245a4fce.js"><link rel="prefetch" href="/vue-design/assets/js/1.c80fb50c.js"><link rel="prefetch" href="/vue-design/assets/js/3.5ff301cc.js"><link rel="prefetch" href="/vue-design/assets/js/4.d55a8a45.js"><link rel="prefetch" href="/vue-design/assets/js/5.de301e64.js"><link rel="prefetch" href="/vue-design/assets/js/6.ee9d7645.js"><link rel="prefetch" href="/vue-design/assets/js/7.bb3d8a99.js"><link rel="prefetch" href="/vue-design/assets/js/8.91d08b09.js"><link rel="prefetch" href="/vue-design/assets/js/9.127d2420.js"><link rel="prefetch" href="/vue-design/assets/js/10.fb36caab.js"><link rel="prefetch" href="/vue-design/assets/js/11.baed150d.js"><link rel="prefetch" href="/vue-design/assets/js/12.05bf78c4.js"><link rel="prefetch" href="/vue-design/assets/js/13.1a16c2d8.js"><link rel="prefetch" href="/vue-design/assets/js/14.df632fc3.js"><link rel="prefetch" href="/vue-design/assets/js/15.54518f91.js"><link rel="prefetch" href="/vue-design/assets/js/17.5d50831e.js"><link rel="prefetch" href="/vue-design/assets/js/18.cfb121a5.js"><link rel="prefetch" href="/vue-design/assets/js/19.ea3a33b3.js"><link rel="prefetch" href="/vue-design/assets/js/20.82648a16.js"><link rel="prefetch" href="/vue-design/assets/js/21.3997c764.js"><link rel="prefetch" href="/vue-design/assets/js/22.87e816f4.js"><link rel="prefetch" href="/vue-design/assets/js/23.97adb41a.js"><link rel="prefetch" href="/vue-design/assets/js/24.c0a38018.js"><link rel="prefetch" href="/vue-design/assets/js/25.340a61bb.js"><link rel="prefetch" href="/vue-design/assets/js/26.64ab7cb1.js"><link rel="prefetch" href="/vue-design/assets/js/27.4362c347.js"><link rel="prefetch" href="/vue-design/assets/js/28.d782d853.js"><link rel="prefetch" href="/vue-design/assets/js/29.0ebec439.js"><link rel="prefetch" href="/vue-design/assets/js/30.2a382cc1.js"><link rel="prefetch" href="/vue-design/assets/js/31.843e3c79.js"><link rel="prefetch" href="/vue-design/assets/js/32.e3466f53.js"><link rel="prefetch" href="/vue-design/assets/js/33.c267f34d.js">
    <link rel="stylesheet" href="/vue-design/assets/css/0.styles.513e2ce8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/vue-design/" class="home-link router-link-active"><!----><span class="site-name">
      VueæŠ€æœ¯å†…å¹•
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-design/art/" class="nav-link">æ­£æ–‡</a></div><div class="nav-item"><a href="/vue-design/appendix/" class="nav-link">é™„å½•</a></div><div class="nav-item"><a href="/vue-design/more/" class="nav-link router-link-active">æ‰©å±•é˜…è¯»</a></div><div class="nav-item"><a href="/vue-design/tools/" class="nav-link">è¾…åŠ©å·¥å…·</a></div><div class="nav-item"><a href="/vue-design/donate/" class="nav-link">äººä¹‹åˆ</a></div><div class="nav-item"><a href="/vue-design/about/" class="nav-link">å…³äº</a></div><a href="https://github.com/HcySunYang/vue-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-design/art/" class="nav-link">æ­£æ–‡</a></div><div class="nav-item"><a href="/vue-design/appendix/" class="nav-link">é™„å½•</a></div><div class="nav-item"><a href="/vue-design/more/" class="nav-link router-link-active">æ‰©å±•é˜…è¯»</a></div><div class="nav-item"><a href="/vue-design/tools/" class="nav-link">è¾…åŠ©å·¥å…·</a></div><div class="nav-item"><a href="/vue-design/donate/" class="nav-link">äººä¹‹åˆ</a></div><div class="nav-item"><a href="/vue-design/about/" class="nav-link">å…³äº</a></div><a href="https://github.com/HcySunYang/vue-design" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><div><ins data-ad-client="ca-pub-4613560834313397" data-ad-slot="2465217753" class="adsbygoogle" style="display:block;box-sizing:border-box;width:100%;height:120px;margin:10px auto 0;"></ins></div><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>æ‰©å±•é˜…è¯»</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/vue-design/more/" class="sidebar-link">æ‰©å±•é˜…è¯»</a></li><li><a href="/vue-design/more/vue-hoc.html" class="active sidebar-link">æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-design/more/vue-hoc.html#æ¢ç´¢vueé«˜é˜¶ç»„ä»¶" class="sidebar-link">æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="/vue-design/more/vue-hoc.html#ä»-react-è¯´èµ·" class="sidebar-link">ä» React è¯´èµ·</a></li><li class="sidebar-sub-header"><a href="/vue-design/more/vue-hoc.html#vue-ä¸­çš„é«˜é˜¶ç»„ä»¶" class="sidebar-link">Vue ä¸­çš„é«˜é˜¶ç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="/vue-design/more/vue-hoc.html#ä¸ºä»€ä¹ˆåœ¨-vue-ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾" class="sidebar-link">ä¸ºä»€ä¹ˆåœ¨ Vue ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾</a></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h2 id="æ¢ç´¢vueé«˜é˜¶ç»„ä»¶"><a href="#æ¢ç´¢vueé«˜é˜¶ç»„ä»¶" aria-hidden="true" class="header-anchor">#</a> æ¢ç´¢Vueé«˜é˜¶ç»„ä»¶</h2><p>é«˜é˜¶ç»„ä»¶(<code>HOC</code>)æ˜¯ <code>React</code> ç”Ÿæ€ç³»ç»Ÿçš„å¸¸ç”¨è¯æ±‡ï¼Œ<code>React</code> ä¸­ä»£ç å¤ç”¨çš„ä¸»è¦æ–¹å¼å°±æ˜¯ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå¹¶ä¸”è¿™ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„åšæ³•ã€‚è€Œ <code>Vue</code> ä¸­å¤ç”¨ä»£ç çš„ä¸»è¦æ–¹å¼æ˜¯ä½¿ç”¨ <code>mixins</code>ï¼Œå¹¶ä¸”åœ¨ <code>Vue</code> ä¸­å¾ˆå°‘æåˆ°é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µï¼Œè¿™æ˜¯å› ä¸ºåœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶å¹¶ä¸åƒ <code>React</code> ä¸­é‚£æ ·ç®€å•ï¼ŒåŸå› åœ¨äº <code>React</code> å’Œ <code>Vue</code> çš„è®¾è®¡æ€æƒ³ä¸åŒï¼Œä½†å¹¶ä¸æ˜¯è¯´åœ¨ <code>Vue</code> ä¸­å°±ä¸èƒ½ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œåªä¸è¿‡åœ¨ <code>Vue</code> ä¸­ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ‰€å¸¦æ¥çš„æ”¶ç›Šç›¸å¯¹äº <code>mixins</code> å¹¶æ²¡æœ‰è´¨çš„å˜åŒ–ã€‚æœ¬ç¯‡æ–‡ç« ä¸»è¦ä»æŠ€æœ¯æ€§çš„è§’åº¦é˜è¿° <code>Vue</code> é«˜é˜¶ç»„ä»¶çš„å®ç°ï¼Œä¸”ä¼šä» <code>React</code> ä¸ <code>Vue</code> ä¸¤è€…çš„è§’åº¦è¿›è¡Œåˆ†æã€‚</p><h2 id="ä»-react-è¯´èµ·"><a href="#ä»-react-è¯´èµ·" aria-hidden="true" class="header-anchor">#</a> ä» React è¯´èµ·</h2><p>èµ·åˆ <code>React</code> ä¹Ÿæ˜¯ä½¿ç”¨ <code>mixins</code> æ¥å®Œæˆä»£ç å¤ç”¨çš„ï¼Œæ¯”å¦‚ä¸ºäº†é¿å…ç»„ä»¶ä¸å¿…è¦çš„é‡å¤æ¸²æŸ“æˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­æ··å…¥ <code>PureRenderMixin</code>ï¼š</p><pre class="language-js"><code><span class="token keyword">const</span> PureRenderMixin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-addons-pure-render-mixin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> MyComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mixins<span class="token punctuation">:</span> <span class="token punctuation">[</span>PureRenderMixin<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>åæ¥ <code>React</code> æŠ›å¼ƒäº†è¿™ç§æ–¹å¼ï¼Œè¿›è€Œä½¿ç”¨ <code>shallowCompare</code>ï¼š</p><pre class="language-js"><code><span class="token keyword">const</span> shallowCompare <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-addons-shallow-compare'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Button <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  shouldComponentUpdate<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">shallowCompare</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>è¿™éœ€è¦ä½ è‡ªå·±åœ¨ç»„ä»¶ä¸­å®ç° <code>shouldComponentUpdate</code> æ–¹æ³•ï¼Œåªä¸è¿‡è¿™ä¸ªæ–¹æ³•å…·ä½“çš„å·¥ä½œç”± <code>shallowCompare</code> å¸®ä½ å®Œæˆï¼Œå³æµ…æ¯”è¾ƒã€‚</p><p>å†åæ¥ <code>React</code> ä¸ºäº†é¿å…å¼€å‘è€…åœ¨ç»„ä»¶ä¸­æ€»æ˜¯è¦å†™è¿™æ ·ä¸€æ®µåŒæ ·çš„ä»£ç ï¼Œè¿›è€Œæ¨èä½¿ç”¨ <code>React.PureComponent</code>ï¼Œæ€»ä¹‹ <code>React</code> åœ¨ä¸€æ­¥æ­¥åœ°è„±ç¦» <code>mixins</code>ï¼Œä»–ä»¬è®¤ä¸º <code>mixins</code> åœ¨ <code>React</code> ç”Ÿæ€ç³»ç»Ÿä¸­å¹¶ä¸æ˜¯ä¸€ç§å¥½çš„æ¨¡å¼(æ³¨æ„ï¼šå¹¶æ²¡æœ‰è¯´ <code>mixins</code> ä¸å¥½ï¼Œä»…ä»…é’ˆå¯¹ <code>React</code> ç”Ÿæ€ç³»ç»Ÿ)ï¼Œè§‚ç‚¹å¦‚ä¸‹ï¼š</p><blockquote><p>1ã€<code>mixins</code> å¸¦æ¥äº†éšå¼ä¾èµ–
2ã€<code>mixins</code> ä¸ <code>mixins</code> ä¹‹é—´ï¼Œ<code>mixins</code> ä¸ç»„ä»¶ä¹‹é—´å®¹æ˜“å¯¼è‡´å‘½åå†²çª
3ã€ç”±äº <code>mixins</code> æ˜¯ä¾µå…¥å¼çš„ï¼Œå®ƒæ”¹å˜äº†åŸç»„ä»¶ï¼Œæ‰€ä»¥ä¿®æ”¹ <code>mixins</code> ç­‰äºä¿®æ”¹åŸç»„ä»¶ï¼Œéšç€éœ€æ±‚çš„å¢é•¿ <code>mixins</code> å°†å˜å¾—å¤æ‚ï¼Œå¯¼è‡´æ»šé›ªçƒçš„å¤æ‚æ€§ã€‚</p></blockquote><p>å…·ä½“å¤§å®¶å¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç«  <a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html" target="_blank" rel="noopener noreferrer">Mixins Considered Harmful</a>ã€‚ä¸è¿‡ <code>HOC</code> ä¹Ÿå¹¶ä¸æ˜¯é“¶å¼¹ï¼Œå®ƒè‡ªç„¶å¸¦æ¥äº†å®ƒçš„é—®é¢˜ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥æŸ¥çœ‹è¿™ä¸ªè§†é¢‘ï¼š<a href="https://www.youtube.com/watch?v=BcVAq3YFiuc" target="_blank" rel="noopener noreferrer">Michael Jackson - Never Write Another HoC</a>ï¼Œå…¶è§‚ç‚¹æ˜¯ï¼š<strong>ä½¿ç”¨æ™®é€šç»„ä»¶é…åˆ <code>render prop</code> å¯ä»¥åšä»»ä½• HOC èƒ½åšçš„äº‹æƒ…</strong>ã€‚</p><p>æœ¬ç¯‡æ–‡ç« ä¸ä¼šè¿‡å¤šè®¨è®º <code>mixins</code> å’Œ <code>HOC</code> è°å¥½è°åï¼Œå°±åƒæŠ€æœ¯æœ¬èº«å°±æ²¡æœ‰å¥½åä¹‹åˆ†ï¼Œåªæœ‰é€‚åˆä¸é€‚åˆã€‚éš¾é“ <code>React</code> å’Œ <code>Vue</code> è¿™ä¿©å“¥ä»¬å„¿ä¸ä¹Ÿæ˜¯è¿™æ ·å—ï¼Ÿ</p><p><code>ok</code>ï¼Œæˆ‘ä»¬å›åˆ°é«˜é˜¶ç»„ä»¶ï¼Œæ‰€è°“é«˜é˜¶ç»„ä»¶å…¶å®å°±æ˜¯é«˜é˜¶å‡½æ•°å•¦ï¼Œ<code>React</code> å’Œ <code>Vue</code> éƒ½è¯æ˜äº†ä¸€ä»¶äº‹å„¿ï¼š<strong>ä¸€ä¸ªå‡½æ•°å°±æ˜¯ä¸€ä¸ªç»„ä»¶</strong>ã€‚æ‰€ä»¥ç»„ä»¶æ˜¯å‡½æ•°è¿™ä¸ªå‘½é¢˜æˆç«‹äº†ï¼Œé‚£é«˜é˜¶ç»„ä»¶å¾ˆè‡ªç„¶çš„å°±æ˜¯é«˜é˜¶å‡½æ•°ï¼Œå³ä¸€ä¸ªè¿”å›å‡½æ•°çš„å‡½æ•°ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ <code>React</code> ä¸­å†™é«˜é˜¶ç»„ä»¶å°±æ˜¯åœ¨å†™é«˜é˜¶å‡½æ•°ï¼Œå¾ˆç®€å•ï¼Œé‚£æ˜¯ä¸æ˜¯åœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶ä¹ŸåŒæ ·ç®€å•å‘¢ï¼Ÿå…¶å® <code>Vue</code> ç¨å¾®å¤æ‚ï¼Œç”šè‡³éœ€è¦ä½ å¯¹ <code>Vue</code> è¶³å¤Ÿäº†è§£ï¼Œæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä¸€èµ·åœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶ï¼Œåœ¨æ–‡ç« çš„åé¢ä¼šåˆ†æä¸ºä»€ä¹ˆåŒæ ·éƒ½æ˜¯ <code>å‡½æ•°å°±æ˜¯ç»„ä»¶</code> çš„æ€æƒ³ï¼Œ<code>Vue</code> å´ä¸èƒ½åƒ <code>React</code> é‚£æ ·è½»æ¾åœ°å®ç°é«˜é˜¶ç»„ä»¶ã€‚</p><p>å› æ­¤æˆ‘ä»¬æœ‰å¿…è¦åœ¨å®ç° <code>Vue</code> é«˜é˜¶ç»„ä»¶ä¹‹å‰å……åˆ†äº†è§£ <code>React</code> ä¸­çš„é«˜é˜¶ç»„ä»¶ï¼Œçœ‹ä¸‹é¢çš„ <code>React</code> ä»£ç ï¼š</p><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
    <span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'with console: componentDidMount'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p><code>WithConsole</code> å°±æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p><blockquote><p>1ã€é«˜é˜¶ç»„ä»¶(<code>HOC</code>)åº”è¯¥æ˜¯æ— å‰¯ä½œç”¨çš„çº¯å‡½æ•°ï¼Œä¸”ä¸åº”è¯¥ä¿®æ”¹åŸç»„ä»¶</p></blockquote><p>å¯ä»¥çœ‹åˆ° <code>WithConsole</code> å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°å¹¶è¿”å›äº†ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œåœ¨æ–°ç»„ä»¶çš„ <code>render</code> å‡½æ•°ä¸­ä»…ä»…æ¸²æŸ“äº†è¢«åŒ…è£…çš„ç»„ä»¶(<code>WrappedComponent</code>)ï¼Œå¹¶æ²¡æœ‰ä¾µå…¥å¼åœ°ä¿®æ”¹å®ƒã€‚</p><blockquote><p>2ã€é«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¸å…³å¿ƒä½ ä¼ é€’çš„æ•°æ®(<code>props</code>)æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)ä¸å…³å¿ƒæ•°æ®æ¥æº</p></blockquote><p>è¿™æ˜¯ä¿è¯é«˜é˜¶ç»„ä»¶ä¸è¢«åŒ…è£…ç»„ä»¶èƒ½å¤Ÿå®Œç¾é…åˆçš„æ ¹æœ¬</p><blockquote><p>3ã€é«˜é˜¶ç»„ä»¶(<code>HOC</code>)æ¥æ”¶åˆ°çš„ <code>props</code> åº”è¯¥é€ä¼ ç»™è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)</p></blockquote><p>é«˜é˜¶ç»„ä»¶å®Œå…¨å¯ä»¥æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ <code>props</code>ï¼Œä½†æ˜¯é™¤æ­¤ä¹‹å¤–ï¼Œè¦å°†å…¶ä½™ <code>props</code> é€ä¼ ï¼Œå¦åˆ™åœ¨å±‚çº§è¾ƒæ·±çš„åµŒå¥—å…³ç³»ä¸­(<code>è¿™æ˜¯é«˜é˜¶ç»„ä»¶çš„å¸¸è§é—®é¢˜</code>)å°†é€ æˆ <code>props</code> é˜»å¡ã€‚</p><p>ä»¥ä¸Šæ˜¯ <code>React</code> ä¸­é«˜é˜¶ç»„ä»¶çš„åŸºæœ¬çº¦å®šï¼Œé™¤æ­¤ä¹‹å¤–è¿˜è¦æ³¨æ„å…¶ä»–é—®é¢˜ï¼Œå¦‚ï¼šé«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¸åº”è¯¥åœ¨ <code>render</code> å‡½æ•°ä¸­åˆ›å»ºï¼›é«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¹Ÿéœ€è¦å¤åˆ¶ç»„ä»¶ä¸­çš„é™æ€æ–¹æ³•ï¼›é«˜é˜¶ç»„ä»¶(<code>HOC</code>)ä¸­çš„ <code>ref</code> å¼•ç”¨çš„æ˜¯æœ€å¤–å±‚çš„å®¹å™¨ç»„ä»¶è€Œä¸æ˜¯è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>) ç­‰ç­‰ã€‚</p><h2 id="vue-ä¸­çš„é«˜é˜¶ç»„ä»¶"><a href="#vue-ä¸­çš„é«˜é˜¶ç»„ä»¶" aria-hidden="true" class="header-anchor">#</a> Vue ä¸­çš„é«˜é˜¶ç»„ä»¶</h2><p>äº†è§£äº†è¿™äº›ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç€æ‰‹å®ç° <code>Vue</code> é«˜é˜¶ç»„ä»¶äº†ï¼Œä¸ºäº†è®©å¤§å®¶æœ‰ä¸€ä¸ªç›´è§‚çš„æ„Ÿå—ï¼Œæˆ‘ä»ç„¶ä¼šä½¿ç”¨ <code>React</code> ä¸ <code>Vue</code> è¿›è¡Œå¯¹æ¯”åœ°è®²è§£ã€‚é¦–å…ˆæ˜¯ä¸€ä¸ªåŸºæœ¬çš„ <code>Vue</code> ç»„ä»¶ï¼Œæˆ‘ä»¬å¸¸ç§°å…¶ä¸ºè¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)ï¼Œå‡è®¾æˆ‘ä»¬çš„ç»„ä»¶å«åš <code>BaseComponent</code>ï¼š</p><p><strong>base-component.vue</strong></p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>props: {{test}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'BaseComponent'</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> Number
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleClick</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'customize-click'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>æˆ‘ä»¬è§‚å¯Ÿä¸€ä¸ª <code>Vue</code> ç»„ä»¶ä¸»è¦è§‚å¯Ÿä¸‰ç‚¹ï¼š<code>props</code>ã€<code>event</code> ä»¥åŠ <code>slots</code>ã€‚å¯¹äº <code>BaseComponent</code> ç»„ä»¶è€Œè¨€ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ•°å­—ç±»å‹çš„ <code>props</code> å³ <code>test</code>ï¼Œå¹¶å‘å°„ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œäº‹ä»¶çš„åç§°æ˜¯ï¼š<code>customize-click</code>ï¼Œæ²¡æœ‰ <code>slots</code>ã€‚æˆ‘ä»¬ä¼šè¿™æ ·ä½¿ç”¨è¯¥ç»„ä»¶ï¼š</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-component</span> <span class="token attr-name">@customize-click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleCustClick<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:test</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><p>ç°åœ¨æˆ‘ä»¬éœ€è¦ <code>base-component</code> ç»„ä»¶æ¯æ¬¡æŒ‚è½½å®Œæˆçš„æ—¶å€™éƒ½æ‰“å°ä¸€å¥è¯ï¼š<code>I have already mounted</code>ï¼ŒåŒæ—¶è¿™ä¹Ÿè®¸æ˜¯å¾ˆå¤šç»„ä»¶çš„éœ€æ±‚ï¼Œæ‰€ä»¥æŒ‰ç…§ <code>mixins</code> çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œé¦–å…ˆå®šä¹‰ä¸ª <code>mixins</code>ï¼š</p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> consoleMixin <span class="token punctuation">{</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>ç„¶ååœ¨ <code>BaseComponent</code> ç»„ä»¶ä¸­å°† <code>consoleMixin</code> æ··å…¥ï¼š</p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'BaseComponent'</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    test<span class="token punctuation">:</span> Number
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mixins<span class="token punctuation">:</span> <span class="token punctuation">[</span> consoleMixin <span class="token punctuation">]</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">handleClick</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'customize-click'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>è¿™æ ·ä½¿ç”¨ <code>BaseComponent</code> ç»„ä»¶çš„æ—¶å€™ï¼Œæ¯æ¬¡æŒ‚è½½å®Œæˆä¹‹åéƒ½ä¼šæ‰“å°ä¸€å¥ <code>I have already mounted</code>ï¼Œä¸è¿‡ç°åœ¨æˆ‘ä»¬è¦ä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„æ–¹å¼å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œå›å¿†é«˜é˜¶ç»„ä»¶çš„å®šä¹‰ï¼š<strong>æ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶</strong>ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬éœ€è¦æ€è€ƒçš„æ˜¯ï¼Œåœ¨ <code>Vue</code> ä¸­ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæœ‰çš„åŒå­¦å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œéš¾é“ä¸æ˜¯å‡½æ•°å—ï¼Ÿå¯¹ï¼Œ<code>Vue</code> ä¸­ç»„ä»¶æ˜¯å‡½æ•°æ²¡æœ‰é—®é¢˜ï¼Œä¸è¿‡é‚£æ˜¯æœ€ç»ˆç»“æœï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨å•æ–‡ä»¶ç»„ä»¶ä¸­çš„ç»„ä»¶å®šä¹‰å…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„é€‰é¡¹å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'BaseComponent'</span><span class="token punctuation">,</span>
  props<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  mixins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>è¿™ä¸å°±æ˜¯ä¸€ä¸ªçº¯å¯¹è±¡å—ï¼Ÿæ‰€ä»¥å½“æˆ‘ä»¬ä»å•æ–‡ä»¶ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶çš„æ—¶å€™ï¼š</p><pre class="language-js"><code><span class="token keyword">import</span> BaseComponent <span class="token keyword">from</span> <span class="token string">'./base-component.vue'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>BaseComponent<span class="token punctuation">)</span>
</code></pre><p>æ€è€ƒä¸€ä¸‹ï¼Œè¿™é‡Œçš„ <code>BaseComponent</code> æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å‡½æ•°å—ï¼Ÿä¸æ˜¯ï¼Œè™½ç„¶å•æ–‡ä»¶ç»„ä»¶ä¼šè¢« <code>vue-loader</code> å¤„ç†ï¼Œä½†å¤„ç†åçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„ <code>BaseComponent</code> ä»ç„¶è¿˜æ˜¯ä¸€ä¸ªæ™®é€šçš„ JSON å¯¹è±¡ï¼Œåªä¸è¿‡å½“ä½ æŠŠè¿™ä¸ªå¯¹è±¡æ³¨å†Œä¸ºç»„ä»¶(<code>components</code> é€‰é¡¹)ä¹‹åï¼Œ<code>Vue</code> æœ€ç»ˆä¼šä»¥è¯¥å¯¹è±¡ä¸ºå‚æ•°åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¯¥æ„é€ å‡½æ•°å°±æ˜¯ç”Ÿäº§ç»„ä»¶å®ä¾‹çš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥åœ¨ <code>Vue</code> ä¸­ç»„ä»¶ç¡®å®æ˜¯å‡½æ•°ï¼Œåªä¸è¿‡é‚£æ˜¯æœ€ç»ˆç»“æœç½¢äº†ï¼Œåœ¨è¿™ä¹‹å‰æˆ‘ä»¬å®Œå…¨å¯ä»¥è¯´åœ¨ <code>Vue</code> ä¸­ç»„ä»¶ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œå°±åƒå•æ–‡ä»¶ç»„ä»¶ä¸­æ‰€å¯¼å‡ºçš„å¯¹è±¡ä¸€æ ·ã€‚</p><p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ <code>Vue</code> ä¸­ä¸€ä¸ªç»„ä»¶å¯ä»¥ä»¥çº¯å¯¹è±¡çš„å½¢å¼å­˜åœ¨ï¼Œæ‰€ä»¥ <code>Vue</code> ä¸­çš„é«˜é˜¶ç»„ä»¶å¯ä»¥è¿™æ ·å®šä¹‰ï¼š<strong>æ¥æ”¶ä¸€ä¸ªçº¯å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„çº¯å¯¹è±¡</strong>ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><p><strong>hoc.js</strong></p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token string">'&lt;wrapped v-on=&quot;$listeners&quot; v-bind=&quot;$attrs&quot;/&gt;'</span><span class="token punctuation">,</span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      wrapped<span class="token punctuation">:</span> WrappedComponent
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p><code>WithConsole</code> å°±æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼š<code>WrappedComponent</code>ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚åœ¨æ–°çš„ç»„ä»¶å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å°† <code>WrappedComponent</code> æ³¨å†Œä¸º <code>wrapped</code> ç»„ä»¶ï¼Œå¹¶åœ¨ <code>template</code> ä¸­å°†å…¶æ¸²æŸ“å‡ºæ¥ï¼ŒåŒæ—¶æ·»åŠ  <code>mounted</code> é’©å­ï¼Œæ‰“å° <code>I have already mounted</code>ã€‚</p><p>ä»¥ä¸Šå°±å®Œæˆäº†ä¸ <code>mixins</code> åŒæ ·çš„åŠŸèƒ½ï¼Œä¸è¿‡è¿™ä¸€æ¬¡æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯é«˜é˜¶ç»„ä»¶ï¼Œæ‰€ä»¥æ˜¯éä¾µå…¥å¼çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¿®æ”¹åŸç»„ä»¶(<code>WrappedComponent</code>)ï¼Œè€Œæ˜¯åœ¨æ–°ç»„ä»¶ä¸­æ¸²æŸ“äº†åŸç»„ä»¶ï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹åŸç»„ä»¶åšä»»ä½•ä¿®æ”¹ã€‚å¹¶ä¸”è¿™é‡Œå¤§å®¶è¦æ³¨æ„ <code>$listeners</code> å’Œ <code>$attrs</code>ï¼š</p><pre class="language-js"><code><span class="token string">'&lt;wrapped v-on=&quot;$listeners&quot; v-bind=&quot;$attrs&quot;/&gt;'</span>
</code></pre><p>è¿™ä¹ˆåšæ˜¯å¿…é¡»çš„ï¼Œè¿™å°±ç­‰ä»·äºåœ¨ <code>React</code> ä¸­é€ä¼  <code>props</code>ï¼š</p><pre class="language-js"><code><span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre><p>å¦åˆ™åœ¨ä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„æ—¶å€™ï¼Œè¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)æ¥æ”¶ä¸åˆ° <code>props</code> å’Œ <code>äº‹ä»¶</code>ã€‚</p><p>é‚£è¿™æ ·çœŸçš„å°±å®Œç¾è§£å†³é—®é¢˜äº†å—ï¼Ÿä¸æ˜¯çš„ï¼Œé¦–å…ˆ <code>template</code> é€‰é¡¹åªæœ‰åœ¨å®Œæ•´ç‰ˆçš„ <code>Vue</code> ä¸­å¯ä»¥ä½¿ç”¨ï¼Œåœ¨è¿è¡Œæ—¶ç‰ˆæœ¬ä¸­æ˜¯ä¸èƒ½ä½¿ç”¨çš„ï¼Œæ‰€ä»¥æœ€èµ·ç æˆ‘ä»¬åº”è¯¥ä½¿ç”¨æ¸²æŸ“å‡½æ•°(<code>render</code>)æ›¿ä»£æ¨¡æ¿(<code>template</code>)ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>hoc.js</strong></p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">render</span> <span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†æ¨¡æ¿æ”¹å†™æˆäº†æ¸²æŸ“å‡½æ•°ï¼Œçœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå®åˆ™ä¸ç„¶ï¼Œä¸Šé¢çš„ä»£ç ä¸­ <code>WrappedComponent</code> ç»„ä»¶ä¾ç„¶æ”¶ä¸åˆ° <code>props</code>ï¼Œæœ‰çš„åŒå­¦å¯èƒ½ä¼šé—®äº†ï¼Œæˆ‘ä»¬ä¸æ˜¯å·²ç»åœ¨ <code>h</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­å°† <code>attrs</code> ä¼ é€’è¿‡å»äº†å—ï¼Œæ€ä¹ˆè¿˜æ”¶ä¸åˆ°ï¼Ÿå½“ç„¶æ”¶ä¸åˆ°ï¼Œ<code>attrs</code> æŒ‡çš„æ˜¯é‚£äº›æ²¡æœ‰è¢«å£°æ˜ä¸º <code>props</code> çš„å±æ€§ï¼Œæ‰€ä»¥åœ¨æ¸²æŸ“å‡½æ•°ä¸­è¿˜éœ€è¦æ·»åŠ  <code>props</code> å‚æ•°ï¼š</p><p><strong>hoc.js</strong></p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">render</span> <span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$props
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>é‚£è¿™æ ·æ˜¯ä¸æ˜¯å¯ä»¥äº†å‘¢ï¼Ÿä¾ç„¶ä¸è¡Œï¼Œå› ä¸º <code>this.$props</code> å§‹ç»ˆæ˜¯ç©ºå¯¹è±¡ï¼Œè¿™æ˜¯å› ä¸ºè¿™é‡Œçš„ <code>this.$props</code> æŒ‡çš„æ˜¯é«˜é˜¶ç»„ä»¶æ¥æ”¶åˆ°çš„ <code>props</code>ï¼Œè€Œé«˜é˜¶ç»„ä»¶æ²¡æœ‰å£°æ˜ä»»ä½• <code>props</code>ï¼Œæ‰€ä»¥ <code>this.$props</code> è‡ªç„¶æ˜¯ç©ºå¯¹è±¡å•¦ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿå¾ˆç®€å•åªéœ€è¦å°†é«˜é˜¶ç»„ä»¶çš„ <code>props</code> è®¾ç½®æˆä¸è¢«åŒ…è£…ç»„ä»¶çš„ <code>props</code> ç›¸åŒå³å¯ï¼š</p><p><strong>hoc.js</strong></p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> WrappedComponent<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token function">render</span> <span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$props
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>ç°åœ¨æ‰æ˜¯ä¸€ä¸ªç¨å¾®å®Œæ•´å¯ç”¨çš„é«˜é˜¶ç»„ä»¶ã€‚å¤§å®¶æ³¨æ„ç”¨è¯ï¼š<code>ç¨å¾®</code>ï¼Œçº³å°¼ï¼Ÿéƒ½ä¿®æ”¹æˆè¿™æ ·äº†è¿˜ä¸è¡Œå—ï¼Ÿå½“ç„¶ï¼Œä¸Šé¢çš„é«˜é˜¶ç»„ä»¶èƒ½å®Œæˆä»¥ä¸‹å·¥ä½œï¼š</p><blockquote><p>1ã€é€ä¼  <code>props</code>
2ã€é€ä¼ æ²¡æœ‰è¢«å£°æ˜ä¸º <code>props</code> çš„å±æ€§
3ã€é€ä¼ äº‹ä»¶</p></blockquote><p>å¤§å®¶ä¸è§‰å¾—ç¼ºå°‘ç‚¹å„¿ä»€ä¹ˆå—ï¼Ÿæˆ‘ä»¬å‰é¢è¯´è¿‡ï¼Œä¸€ä¸ª <code>Vue</code> ç»„ä»¶çš„ä¸‰ä¸ªé‡è¦å› ç´ ï¼š<code>props</code>ã€<code>äº‹ä»¶</code> ä»¥åŠ <code>slots</code>ï¼Œå‰ä¸¤ä¸ªéƒ½æå®šäº†ï¼Œä½† <code>slots</code> è¿˜ä¸è¡Œã€‚æˆ‘ä»¬ä¿®æ”¹ <code>BaseComponent</code> ç»„ä»¶ä¸ºå…¶æ·»åŠ ä¸€ä¸ªå…·åæ’æ§½å’Œé»˜è®¤æ’æ§½ï¼Œå¦‚ä¸‹ï¼š</p><p><strong>base-component.vue</strong></p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>props: {{test}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slot1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- å…·åæ’æ§½ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>===========<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- é»˜è®¤æ’æ§½ --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>ç„¶åæˆ‘ä»¬å†™ä¸‹å¦‚ä¸‹æµ‹è¯•ä»£ç ï¼š</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-component</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slot1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>BaseComponent slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>default slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>base-component</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enhanced-com</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slot1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>EnhancedComponent slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>default slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enhanced-com</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script language-javascript">
  <span class="token keyword">import</span> BaseComponent <span class="token keyword">from</span> <span class="token string">'./base-component.vue'</span>
  <span class="token keyword">import</span> hoc <span class="token keyword">from</span> <span class="token string">'./hoc.js'</span>

  <span class="token keyword">const</span> EnhancedCom <span class="token operator">=</span> <span class="token function">hoc</span><span class="token punctuation">(</span>BaseComponent<span class="token punctuation">)</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    components<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      BaseComponent<span class="token punctuation">,</span>
      EnhancedCom
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>æ¸²æŸ“ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-084715.jpg" alt></p><p>ä¸Šå›¾ä¸­è“è‰²æ¡†æ˜¯ <code>BaseComponent</code> ç»„ä»¶æ¸²æŸ“çš„å†…å®¹ï¼Œæ˜¯æ­£å¸¸çš„ã€‚çº¢è‰²æ¡†æ˜¯é«˜é˜¶ç»„ä»¶æ¸²æŸ“çš„å†…å®¹ï¼Œå¯ä»¥å‘ç°æ— è®ºæ˜¯å…·åæ’æ§½è¿˜æ˜¯é»˜è®¤æ’æ§½ï¼Œå…¨éƒ¨ä¸¢å¤±ã€‚å…¶åŸå› å¾ˆç®€å•ï¼Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨é«˜é˜¶ç»„ä»¶ä¸­æ²¡æœ‰å°†åˆ†å‘çš„æ’æ§½å†…å®¹é€ä¼ ç»™è¢«åŒ…è£…ç»„ä»¶(<code>WrappedComponent</code>)ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ç€ä¿®æ”¹é«˜é˜¶ç»„ä»¶ï¼š</p><p><strong>hoc.js</strong></p><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> WrappedComponent<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token function">render</span> <span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token comment">// å°† this.$slots æ ¼å¼åŒ–ä¸ºæ•°ç»„ï¼Œå› ä¸º h å‡½æ•°ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å­èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„</span>
      <span class="token keyword">const</span> slots <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs<span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$props
      <span class="token punctuation">}</span><span class="token punctuation">,</span> slots<span class="token punctuation">)</span> <span class="token comment">// å°† slots ä½œä¸º h å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>å¥½å•¦ï¼Œå¤§åŠŸå‘Šæˆåˆ·æ–°é¡µé¢ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-090407.jpg" alt></p><p>çº³å°¼ğŸ˜±ï¼Ÿæˆ‘ä»¬å‘ç°ï¼Œåˆ†å‘çš„å†…å®¹ç¡®å®æ˜¯æ¸²æŸ“å‡ºæ¥äº†ï¼Œä¸è¿‡è²Œä¼¼é¡ºåºä¸å¤ªå¯¹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è“è‰²æ¡†æ˜¯æ­£å¸¸çš„ï¼Œåœ¨å…·åæ’æ§½ä¸é»˜è®¤æ’æ§½çš„ä¸­é—´æ˜¯æœ‰åˆ†ç•Œçº¿(<code>===========</code>)çš„ï¼Œè€Œçº¢è‰²æ¡†ä¸­æ‰€æœ‰çš„æ’æ§½å…¨éƒ¨æ¸²æŸ“åˆ°äº†åˆ†ç•Œçº¿(<code>===========</code>)çš„ä¸‹é¢ï¼Œçœ‹ä¸Šå»è²Œä¼¼å…·åæ’æ§½ä¹Ÿè¢«ä½œä¸ºé»˜è®¤æ’æ§½å¤„ç†äº†ã€‚è¿™åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>æƒ³å¼„æ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œå°±å›åˆ°äº†æ–‡ç« å¼€å§‹æ—¶æˆ‘æåˆ°çš„ä¸€ç‚¹ï¼Œå³ä½ éœ€è¦å¯¹ <code>Vue</code> çš„å®ç°åŸç†æœ‰æ‰€äº†è§£æ‰è¡Œï¼Œå¦åˆ™æ— è§£ã€‚æ¥ä¸‹æ¥å°±ä»åŸç†å‡ºå‘æ¥è®²è§£å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜çš„æ ¹æºåœ¨äºï¼š<strong><code>Vue</code> åœ¨å¤„ç†å…·åæ’æ§½çš„æ—¶å€™ä¼šè€ƒè™‘ä½œç”¨åŸŸçš„å› ç´ </strong>ã€‚ä¸æ˜ç™½æ²¡å…³ç³»ï¼Œæˆ‘ä»¬ä¸€ç‚¹ç‚¹åˆ†æã€‚</p><p>é¦–å…ˆè¡¥å……ä¸€ä¸ªæç¤ºï¼š<strong><code>Vue</code> ä¼šæŠŠæ¨¡æ¿(<code>template</code>)ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°(<code>render</code>)</strong>ï¼Œæ¯”å¦‚å¦‚ä¸‹æ¨¡æ¿ï¼š</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slot1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>BaseComponent slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>ä¼šè¢«ç¼–è¯‘æˆå¦‚ä¸‹æ¸²æŸ“å‡½æ•°ï¼š</p><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _vm <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">var</span> _h <span class="token operator">=</span> _vm<span class="token punctuation">.</span>$createElement
  <span class="token keyword">var</span> _c <span class="token operator">=</span> _vm<span class="token punctuation">.</span>_self<span class="token punctuation">.</span>_c <span class="token operator">||</span> _h
  <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;h2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span> slot<span class="token punctuation">:</span> <span class="token string">&quot;slot1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      slot<span class="token punctuation">:</span> <span class="token string">&quot;slot1&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
      _vm<span class="token punctuation">.</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;BaseComponent slot&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><p>æƒ³è¦æŸ¥çœ‹ä¸€ä¸ªç»„ä»¶çš„æ¨¡æ¿è¢«ç¼–è¯‘åçš„æ¸²æŸ“å‡½æ•°å¾ˆç®€å•ï¼Œåªéœ€è¦è®¿é—® <code>this.$options.render</code> å³å¯ã€‚è§‚å¯Ÿä¸Šé¢çš„æ¸²æŸ“å‡½æ•°æˆ‘ä»¬å‘ç°æ™®é€šçš„ <code>DOM</code> æ˜¯é€šè¿‡ <code>_c</code> å‡½æ•°åˆ›å»ºå¯¹åº”çš„ <code>VNode</code> çš„ã€‚ç°åœ¨æˆ‘ä»¬ä¿®æ”¹æ¨¡æ¿ï¼Œæ¨¡æ¿ä¸­é™¤äº†æœ‰æ™®é€š <code>DOM</code> ä¹‹å¤–ï¼Œè¿˜æœ‰ç»„ä»¶ï¼Œå¦‚ä¸‹ï¼š</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-component</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slot1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>BaseComponent slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>default slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>base-component</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>é‚£ä¹ˆç”Ÿæˆçš„æ¸²æŸ“å‡½æ•°(<code>render</code>)æ˜¯è¿™æ ·çš„ï¼š</p><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _vm <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">var</span> _h <span class="token operator">=</span> _vm<span class="token punctuation">.</span>$createElement
  <span class="token keyword">var</span> _c <span class="token operator">=</span> _vm<span class="token punctuation">.</span>_self<span class="token punctuation">.</span>_c <span class="token operator">||</span> _h
  <span class="token keyword">return</span> <span class="token function">_c</span><span class="token punctuation">(</span>
    <span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;base-component&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;h2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> attrs<span class="token punctuation">:</span> <span class="token punctuation">{</span> slot<span class="token punctuation">:</span> <span class="token string">&quot;slot1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> slot<span class="token punctuation">:</span> <span class="token string">&quot;slot1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
          _vm<span class="token punctuation">.</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;BaseComponent slot&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        _vm<span class="token punctuation">.</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">_c</span><span class="token punctuation">(</span><span class="token string">&quot;p&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>_vm<span class="token punctuation">.</span><span class="token function">_v</span><span class="token punctuation">(</span><span class="token string">&quot;default slot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token number">1</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><p>æˆ‘ä»¬å‘ç°æ— è®ºæ˜¯æ™®é€šDOMè¿˜æ˜¯ç»„ä»¶ï¼Œéƒ½æ˜¯é€šè¿‡ <code>_c</code> å‡½æ•°åˆ›å»ºå…¶å¯¹åº”çš„ <code>VNode</code> çš„ã€‚å…¶å® <code>_c</code> åœ¨ <code>Vue</code> å†…éƒ¨å°±æ˜¯ <code>createElement</code> å‡½æ•°ã€‚<code>createElement</code> å‡½æ•°ä¼šè‡ªåŠ¨æ£€æµ‹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸æ˜¯æ™®é€šDOMæ ‡ç­¾ï¼Œå¦‚æœä¸æ˜¯æ™®é€šDOMæ ‡ç­¾é‚£ä¹ˆ <code>createElement</code> ä¼šå°†å…¶è§†ä¸ºç»„ä»¶ï¼Œåœ¨å­ç»„ä»¶æ¸²æŸ“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™é¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼š<strong>ç»„ä»¶éœ€è¦çŸ¥é“çˆ¶çº§æ¨¡æ¿ä¸­æ˜¯å¦ä¼ é€’äº† <code>slot</code> ä»¥åŠä¼ é€’äº†å¤šå°‘ï¼Œä¼ é€’çš„æ˜¯å…·åçš„è¿˜æ˜¯ä¸å…·åçš„ç­‰ç­‰</strong>ã€‚é‚£ä¹ˆå­ç»„ä»¶å¦‚ä½•æ‰èƒ½å¾—çŸ¥è¿™äº›ä¿¡æ¯å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå‡å¦‚ç»„ä»¶çš„æ¨¡æ¿å¦‚ä¸‹ï¼š</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-component</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slot1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>BaseComponent slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>default slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>base-component</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>çˆ¶ç»„ä»¶çš„æ¨¡æ¿æœ€ç»ˆä¼šç”Ÿæˆçˆ¶ç»„ä»¶å¯¹åº”çš„ <code>VNode</code>ï¼Œæ‰€ä»¥ä»¥ä¸Šæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code> å…¨éƒ¨ç”±çˆ¶ç»„ä»¶æ‰€æœ‰ï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºå­ç»„ä»¶å®ä¾‹çš„æ—¶å€™èƒ½å¦é€šè¿‡è·å–çˆ¶ç»„ä»¶çš„ <code>VNode</code> è¿›è€Œæ‹¿åˆ° <code>slot</code> çš„å†…å®¹å‘¢ï¼Ÿå³é€šè¿‡çˆ¶ç»„ä»¶å°†ä¸‹é¢è¿™æ®µæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code> æ‹¿åˆ°ï¼š</p><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-component</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>slot1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>BaseComponent slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>default slot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>base-component</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>å¦‚æœèƒ½å¤Ÿé€šè¿‡çˆ¶çº§æ‹¿åˆ°è¿™æ®µæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code>ï¼Œé‚£ä¹ˆå­ç»„ä»¶å°±çŸ¥é“è¦æ¸²æŸ“å“ªäº› <code>slot</code> äº†ï¼Œå…¶å® <code>Vue</code> å†…éƒ¨å°±æ˜¯è¿™ä¹ˆå¹²çš„ï¼Œå®é™…ä¸Šä½ å¯ä»¥é€šè¿‡è®¿é—®å­ç»„ä»¶çš„ <code>this.$vnode</code> æ¥è·å–è¿™æ®µæ¨¡æ¿å¯¹åº”çš„ <code>VNode</code>ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-102532.jpg" alt></p><p>å…¶ä¸­ <code>this.$vnode</code> å¹¶æ²¡æœ‰å†™è¿› <code>Vue</code> çš„å®˜æ–¹æ–‡æ¡£ã€‚å­ç»„ä»¶æ‹¿åˆ°äº†éœ€è¦æ¸²æŸ“çš„ <code>slot</code> ä¹‹åè¿›å…¥åˆ°äº†å…³é”®çš„ä¸€æ­¥ï¼Œè¿™ä¸€æ­¥å°±æ˜¯å¯¼è‡´é«˜é˜¶ç»„ä»¶ä¸­é€ä¼  <code>slot</code> ç»™ <code>BaseComponent</code> å´æ— æ³•æ­£ç¡®æ¸²æŸ“çš„åŸå› ï¼Œçœ‹ä¸‹å›¾ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-104411.jpg" alt></p><p>è¿™å¼ å›¾ä¸ä¸Šä¸€å¼ å›¾ç›¸åŒï¼Œåœ¨å­ç»„ä»¶ä¸­æ‰“å° <code>this.$vnode</code>ï¼Œæ ‡æ³¨ä¸­çš„ <code>context</code> å¼•ç”¨ç€ <code>VNode</code> è¢«åˆ›å»ºæ—¶æ‰€åœ¨çš„ç»„ä»¶å®ä¾‹ï¼Œç”±äº <code>this.$vnode</code> ä¸­å¼•ç”¨çš„ <code>VNode</code> å¯¹è±¡æ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­è¢«åˆ›å»ºçš„ï¼Œæ‰€ä»¥ <code>this.$vnode</code> ä¸­çš„ <code>context</code> å¼•ç”¨ç€çˆ¶å®ä¾‹ã€‚ç†è®ºä¸Šå›¾ä¸­æ ‡æ³¨çš„ä¸¤ä¸ª <code>context</code> åº”è¯¥æ˜¯ç›¸ç­‰çš„ï¼š</p><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>context <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>context<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><p>è€Œ <code>Vue</code> å†…éƒ¨åšäº†ä¸€ä»¶å¾ˆé‡è¦çš„äº‹å„¿ï¼Œå³ä¸Šé¢é‚£ä¸ªè¡¨è¾¾å¼å¿…é¡»æˆç«‹ï¼Œæ‰èƒ½å¤Ÿæ­£ç¡®å¤„ç†å…·å <code>slot</code>ï¼Œå¦åˆ™å³ä½¿ <code>slot</code> å…·åä¹Ÿä¸ä¼šè¢«è€ƒè™‘ï¼Œè€Œæ˜¯è¢«ä½œä¸ºé»˜è®¤æ’æ§½ã€‚è¿™å°±æ˜¯é«˜é˜¶ç»„ä»¶ä¸­ä¸èƒ½æ­£ç¡®æ¸²æŸ“ <code>slot</code> çš„åŸå› ã€‚</p><p>é‚£ä¹ˆä¸ºä»€ä¹ˆé«˜é˜¶ç»„ä»¶ä¸­ä¸Šé¢çš„è¡¨è¾¾å¼å°±ä¸æˆç«‹äº†å‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºç”±äºé«˜é˜¶ç»„ä»¶çš„å¼•å…¥ï¼Œåœ¨åŸæœ¬çš„çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶ä¹‹é—´æ’å…¥äº†ä¸€ä¸ªç»„ä»¶(<code>ä¹Ÿå°±æ˜¯é«˜é˜¶ç»„ä»¶</code>)ï¼Œè¿™å¯¼è‡´åœ¨å­ç»„ä»¶ä¸­è®¿é—®çš„ <code>this.$vnode</code> å·²ç»ä¸æ˜¯åŸæ¥çš„çˆ¶ç»„ä»¶ä¸­çš„ <code>VNode</code> ç‰‡æ®µäº†ï¼Œè€Œæ˜¯é«˜é˜¶ç»„ä»¶çš„ <code>VNode</code> ç‰‡æ®µï¼Œæ‰€ä»¥æ­¤æ—¶ <code>this.$vnode.context</code> å¼•ç”¨çš„æ˜¯é«˜é˜¶ç»„ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬å´å°† <code>slot</code> é€ä¼ ï¼Œ<code>slot</code> ä¸­çš„ <code>VNode</code> çš„ <code>context</code> å¼•ç”¨çš„è¿˜æ˜¯åŸæ¥çš„çˆ¶ç»„ä»¶å®ä¾‹ï¼Œæ‰€ä»¥è¿™å°±é€ æˆäº†ä»¥ä¸‹è¡¨è¾¾å¼ä¸ºå‡ï¼š</p><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>context <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$vnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>context<span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre><p>æœ€ç»ˆå¯¼è‡´å…·åæ’æ§½è¢«ä½œä¸ºé»˜è®¤æ’æ§½ï¼Œä»è€Œæ¸²æŸ“ä¸æ­£ç¡®ã€‚</p><p>è€Œè§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹ <code>slot</code> ä¸­ <code>VNode</code> çš„ <code>context</code> å€¼ä¸ºé«˜é˜¶ç»„ä»¶å®ä¾‹å³å¯ï¼Œä¿®æ”¹é«˜é˜¶ç»„ä»¶å¦‚ä¸‹ï¼š</p><p><strong>hoc.js</strong></p><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> WrappedComponent<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token function">render</span> <span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> slots <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">// æ‰‹åŠ¨æ›´æ­£ context</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>vnode <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          vnode<span class="token punctuation">.</span>context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_self
          <span class="token keyword">return</span> vnode
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$props<span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs
      <span class="token punctuation">}</span><span class="token punctuation">,</span> slots<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>ç°åœ¨ï¼Œéƒ½èƒ½å¤Ÿæ­£å¸¸æ¸²æŸ“å•¦ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="http://7xlolm.com1.z0.glb.clouddn.com/2018-01-07-113740.jpg" alt></p><p>è¿™é‡Œçš„å…³é”®ç‚¹é™¤äº†ä½ éœ€è¦äº†è§£ <code>Vue</code> å¤„ç† <code>slot</code> çš„æ–¹å¼ä¹‹å¤–ï¼Œä½ è¿˜è¦çŸ¥é“é€šè¿‡å½“å‰å®ä¾‹ <code>_self</code> å±æ€§è®¿é—®å½“å‰å®ä¾‹æœ¬èº«ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ <code>this</code>ï¼Œå› ä¸º <code>this</code> æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚</p><p>ç°åœ¨è²Œä¼¼çœ‹ä¸Šå»æ²¡ä»€ä¹ˆé—®é¢˜äº†ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜å¿˜è®°äº†ä¸€ä»¶äº‹å„¿ï¼Œå³ <code>scopedSlots</code>ï¼Œä¸è¿‡ <code>scopedSlots</code> ä¸ <code>slot</code> çš„å®ç°æœºåˆ¶ä¸ä¸€æ ·ï¼Œæœ¬è´¨ä¸Š <code>scopedSlots</code> å°±æ˜¯ä¸€ä¸ªæ¥æ”¶æ•°æ®ä½œä¸ºå‚æ•°å¹¶æ¸²æŸ“ <code>VNode</code> çš„å‡½æ•°ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ <code>context</code> çš„æ¦‚å¿µï¼Œæ‰€ä»¥ç›´æ¥é€ä¼ å³å¯ï¼š</p><p><strong>hoc.js</strong></p><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">WithConsole</span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I have already mounted'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    props<span class="token punctuation">:</span> WrappedComponent<span class="token punctuation">.</span>props<span class="token punctuation">,</span>
    <span class="token function">render</span> <span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> slots <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>vnode <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          vnode<span class="token punctuation">.</span>context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_self
          <span class="token keyword">return</span> vnode
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        on<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$listeners<span class="token punctuation">,</span>
        props<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$props<span class="token punctuation">,</span>
        <span class="token comment">// é€ä¼  scopedSlots</span>
        scopedSlots<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$scopedSlots<span class="token punctuation">,</span>
        attrs<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$attrs
      <span class="token punctuation">}</span><span class="token punctuation">,</span> slots<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œä¸€ä¸ªé«˜é˜¶ç»„ä»¶åº”è¯¥å…·å¤‡çš„åŸºæœ¬åŠŸèƒ½ç®—æ˜¯å®ç°äº†ï¼Œä½†è¿™ä»…ä»…æ˜¯ä¸ªå¼€å§‹ï¼Œè¦å®ç°ä¸€ä¸ªå®Œæ•´å¥å£®çš„ <code>Vue</code> é«˜é˜¶ç»„ä»¶ï¼Œè¿˜è¦è€ƒè™‘å¾ˆå¤šå†…å®¹ï¼Œæ¯”å¦‚ï¼š</p><blockquote><p>å‡½æ•°å¼ç»„ä»¶ä¸­è¦ä½¿ç”¨ <code>render</code> å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä»£æ›¿ <code>this</code>ã€‚
ä»¥ä¸Šæˆ‘ä»¬åªè®¨è®ºäº†ä»¥çº¯å¯¹è±¡å½¢å¼å­˜åœ¨çš„ <code>Vue</code> ç»„ä»¶ï¼Œç„¶è€Œé™¤äº†çº¯å¯¹è±¡å¤–è¿˜å¯ä»¥æ˜¯å‡½æ•°ã€‚
åˆ›å»º <code>render</code> å‡½æ•°çš„å¾ˆå¤šæ­¥éª¤éƒ½å¯ä»¥è¿›è¡Œå°è£…ã€‚
å¤„ç†æ›´å¤šé«˜é˜¶å‡½æ•°ç»„ä»¶æœ¬èº«çš„é€‰é¡¹(<code>è€Œä¸ä»…ä»…æ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ä¸€ä¸ªç®€å•çš„ç”Ÿå‘½å‘¨æœŸé’©å­</code>)</p></blockquote><p>æˆ‘è§‰å¾—éœ€è¦æ”¾ä¸Šä¸¤ä¸ªå…³äºé«˜é˜¶ç»„ä»¶çš„å‚è€ƒé“¾æ¥ï¼Œä¾›å‚è€ƒäº¤æµï¼š</p><p><a href="https://github.com/vuejs/vue/issues/6201" target="_blank" rel="noopener noreferrer">Discussion: Best way to create a HOC</a><a href="https://github.com/jackmellis/vue-hoc" target="_blank" rel="noopener noreferrer">https://github.com/jackmellis/vue-hoc</a></p><h2 id="ä¸ºä»€ä¹ˆåœ¨-vue-ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾"><a href="#ä¸ºä»€ä¹ˆåœ¨-vue-ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾" aria-hidden="true" class="header-anchor">#</a> ä¸ºä»€ä¹ˆåœ¨ Vue ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒéš¾</h2><p>å‰é¢è¯´è¿‡è¦åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆåœ¨ <code>Vue</code> ä¸­å®ç°é«˜é˜¶ç»„ä»¶æ¯”è¾ƒå¤æ‚è€Œ <code>React</code> æ¯”è¾ƒç®€å•ã€‚è¿™ä¸»è¦æ˜¯äºŒè€…çš„è®¾è®¡æ€æƒ³å’Œè®¾è®¡ç›®æ ‡ä¸åŒï¼Œåœ¨ <code>React</code> ä¸­å†™ç»„ä»¶å°±æ˜¯åœ¨å†™å‡½æ•°ï¼Œå‡½æ•°æ‹¥æœ‰çš„åŠŸèƒ½ç»„ä»¶éƒ½æœ‰ã€‚è€Œ <code>Vue</code> æ›´åƒæ˜¯é«˜åº¦å°è£…çš„å‡½æ•°ï¼Œåœ¨æ›´é«˜çš„å±‚é¢ <code>Vue</code> èƒ½å¤Ÿè®©ä½ è½»æ¾çš„å®Œæˆä¸€äº›äº‹æƒ…ï¼Œä½†ä¸é«˜åº¦çš„å°è£…ç›¸å¯¹çš„å°±æ˜¯æŸå¤±ä¸€å®šçš„çµæ´»ï¼Œä½ éœ€è¦æŒ‰ç…§ä¸€å®šè§„åˆ™æ‰èƒ½ä½¿ç³»ç»Ÿæ›´å¥½åœ°è¿è¡Œã€‚</p><p>æœ‰å¥è¯è¯´çš„å¥½ï¼š</p><blockquote><p>ä¼šäº†ä¸éš¾ï¼Œéš¾äº†ä¸ä¼š</p></blockquote><p>å¤æ‚è¿˜æ˜¯ç®€å•éƒ½æ˜¯ç›¸å¯¹è€Œè¨€çš„ï¼Œæœ€åå¸Œæœ›å¤§å®¶ç©çš„è½¬ <code>Vue</code> ä¹Ÿæ¬£èµçš„äº† <code>React</code>ã€‚</p></div><div class="content edit-link"><a href="https://github.com/HcySunYang/vue-design/edit/master/docs/more/vue-hoc.md" target="_blank" rel="noopener noreferrer">é”™åˆ«å­—çº æ­£</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="content page-nav"><p class="inner"><span class="prev">
        â† <a href="/vue-design/more/" class="prev router-link-active">
          æ‰©å±•é˜…è¯»
        </a></span><!----></p></div></div></div></div>
    <script src="/vue-design/assets/js/2.f22f200a.js" defer></script><script src="/vue-design/assets/js/app.bfcf3ece.js" defer></script>
  </body>
</html>
